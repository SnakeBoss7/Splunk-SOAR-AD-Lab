# Connecting Python to Jira

This guide explains the **logic** and **concepts** behind connecting your Python SOAR script to Jira. This is not a copy-paste script, but a blueprint for how to build it.

## 1. The Bridge: `jira` Python Library
f
To talk to Jira, we use a standard Python library simply called `jira`. It handles all the complex API calls for us.

**Concept**:
Your script acts as a "User" logging into Jira, clicking "Create Button", filling out the form, and hitting "Submit"â€”but it happens in milliseconds.

## 2. Authentication (The Keys to the Castle)

Since you are using a self-hosted (Docker) version of Jira, you should use a **Personal Access Token (PAT)** for authentication. This is more secure than using your password and easier than OAuth for scripts.

### How to get it:
1.  Log in to your local Jira instance (e.g., `http://localhost:8080`).
2.  Click your **User Profile Icon** (top right) -> **Profile**.
3.  In the menu, select **Personal Access Tokens**.
4.  Click **Create token**, give it a name (e.g., `Splunk-SOAR`), and set an expiry if desired.
5.  **Copy the token immediately**. You won't see it again.

### Credentials needed for your script:
*   **Server URL**: `http://localhost:8080` (or your Docker IP).
*   **Token**: The Personal Access Token (PAT) you just copied.
*   *(Note: You typically don't need your username/email when using a PAT with the Python library, just the token and server URL).*

## 3. The Logic Flow

Here is how your Python script should "think" when processing an alert:

### Step A: Initialize Connection
*   **Action**: The script introduces itself to the Jira server using your credentials.
*   **Check**: If the login fails, the script should log an error (e.g., "Authentication Failed").

### Step B: Prepare the "Payload" ( The Ticket Data)
The "Payload" is a dictionary (key-value pairs) that represents the ticket form.

*   **Project**: Tell Jira which project to put the ticket in (e.g., key=`SOC`).
*   **Summary**: Use the Alert Name from Splunk.
*   **Description**: This is the most important part. Combine all your data here:
    *   Raw Event Data (Source IP, User, Host)
    *   **Enrichment Data** (VirusTotal Score from your previous steps)
    *   **AI Analysis** (The explanation generated by GPT/Llama)
*   **Issue Type**: Usually "Task" or "Bug" (or "Incident" if using JSM).

### Step C: Send the Request
*   **Action**: Call the `create_issue` function with your payload.
*   **Result**: Jira sends back the new Ticket ID (e.g., `SOC-105`).

### Step D: Feedback Loop (Optional)
*   You can print the new Ticket URL to your console or send it to Slack so you can click and go straight to the ticket.

## 4. Visualizing the Data Flow

```text
[Splunk Alert] 
      |
      v
[Python Script]
      |
      +--> 1. Extracts IP/Hash
      +--> 2. Checks VirusTotal (Enrichment)
      +--> 3. Asks AI for Analysis
      |
      +--> 4. CONNECTS TO JIRA <--- (We are here)
             |
             +--> Authenticate (PAT / Token)
             +--> Create Ticket (Project="SOC")
                    |
                    +--> Title: "Mimikatz detected"
                    +--> Desc: "AI says this is critical..."
      |
      v
[Jira Ticket Created: SOC-105]
```

## 5. What to Google to Learn More
To write the actual code, search for these terms:
*   "python jira library documentation"
*   "jira api create issue python example"
*   "jira software server personal access token"
